name: "[Pull Request] TEST ACTIONS"

on:
  pull_request:
    branches: [main]

permissions:
  contents: write
  security-events: none
  pull-requests: none
  actions: read
  checks: none
  deployments: read
  issues: read
  packages: none
  repository-projects: none
  statuses: none


jobs:
  # BRANCH NAME
  branchNameAsStep:
    name: TEST BRANCH NAME AS STEP
    runs-on: 'ubuntu-latest'
    steps:
      - id: branchname
        name: Get Branch Details
        uses: ministryofjustice/opg-github-actions/.github/actions/branch-name@v2.8.0-goversion.0
      - name: "BRANCH NAME: [${{steps.branchname.outputs.branch_name}} => ${{steps.branchname.outputs.safe}}]"
        run: echo "VERSION=${{steps.branchname.outputs.branch_name}} => ${{steps.branchname.outputs.safe}}"

  branchNameAsWorkflow:
    name: TEST BRANCH NAME AS WORKFLOW
    uses: ./.github/workflows/data-parse-branch-name.yml
    secrets: inherit

  # TERRAFORM VERSION
  terraformVersionAsStep:
    name: TEST TERRAFORM VERSION AS STEP
    runs-on: 'ubuntu-latest'
    steps:
      - id: version
        name: Get version
        uses: ministryofjustice/opg-github-actions/.github/actions/terraform-version@v2.8.0-goversion.0
        with:
          terraform_directory: "./terraform/account"
      - name: "VERSION: [${{steps.version.outputs.version}}]"
        run: echo "VERSION=${{steps.version.outputs.version}}"

  terraformVersionAsWorkflow:
    name: TEST TERRAFORM VERSION AS WORKFLOW
    uses: ./.github/workflows/data-parse-terraform-version.yml
    with:
      terraform_directory: "./terraform/account"
    secrets: inherit
